<!DOCTYPE HTML>
<!--
Dimension by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>TraVerse</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="/assets/css/main.css" />
	<link rel="stylesheet" href="/assets/css/TraVerse.css" />
	<!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<noscript><link rel="stylesheet" href="/assets/css/noscript.css" /></noscript>
</head>


<body>
<script>
    window.fbAsyncInit = function() {
        FB.init({
            appId      : '1596316047096337',
            cookie     : true,
            xfbml      : true,
            version    : 'v2.10'
        });

        FB.getLoginStatus(function(response) {
			$.ajax({
				type: 'POST',
				url: 'oauth/facebook',
                contentType: 'application/json',
				dataType:'json',
				data: JSON.stringify({
					"accessToken" : response['authResponse']['accessToken'],
					"userID" : (response['authResponse']['userID'])
				}),
				success: function (msg) {

				}
			});

           if(response.status === 'connected') {

		       document.getElementById('status').innerHTML ='we are connected';

		       document.getElementById('SubmitButton').disabled = false;

               document.getElementById('SubmitButton').style.visibility = 'hidden';


           } else if (response.status === 'not_authorized') {
               document.getElementById('status').innerHTML = 'we are not logged in.';
               document.getElementById('SubmitButton').disabled = true;
               document.getElementById('SubmitButton').style.visibility = 'hidden';
           } else {
               document.getElementById('status').innerHTML = 'you are not logged into facebook';
               document.getElementById('SubmitButton').disabled = true;
               document.getElementById('SubmitButton').style.visibility = 'hidden';
                      }
        });
	};

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<!-- Wrapper -->
<div id="status"></div>
<div id="wrapper">

	<!--div style ="margin-left:-65%"-->

	<div id="parent" class="w3-top">
		<div class="w3-bar">
			<input style ="margin-left: 15%" type = "text" name="search" placeholder="Search..."> </div>
		<div  class="fb-login-button" data-max-rows="1" data-size="medium" data-button-type="login_with" data-show-faces="false" data-auto-logout-link="true" data-use-continue-as="false"></div>

		<div type="button">
			<a type="button" href="#songUpload">Upload Track</a>
		</div>
		<!--div>
		<button onclick="addTrack()">Submit</button>
		</div-->

		<!-- Header -->
		<header id="header">


			<nav>
				<ul>
					<!-- <li><a href="#recent">Recent</a></li>
                        <li><a href="#friends">Friends</a></li>
                        <li><a href="#profile">Profile</a></li -->
                        <!--li><a href="#contact">Contact</a></li-->
					<!-- <li><a href="#LogIn">LogIn</a> </li> -->
					<!--<li><a href="#elements">Elements</a></li>-->

				</ul>
			</nav>

		</header>


		<div class="w3-container w3-light-green" style="top: auto" style="text-align: center">
			<h1>TraVerse through music</h1>
		</div>







<!-- Audio Section -->
<div id="child">
	<div>
		<button onclick="listTracks()">Show database tracks</button>
	</div>
	<div>
	<h1>track Name1</h1>
	<audio controls>
		<source src="audio/03%20Engine%2045.mp3 " type="audio/mpeg">
	</audio>
	</div>

	<div>
	<h1>track Name2</h1>
	<audio controls>
		<source src="audio/04%20Slipping%20Away.mp3 " type="audio/mpeg">
	</audio>
</div>
	<div>
	<h1>track Name3</h1>
	<audio controls>
		<source src="audio/07%20White%20Light.mp3 " type="audio/mpeg">


	</audio>
	</div>
</div>


</div>


</div>

</div>

<!--SideBar-->
<!--  <div class="w3-sidebar w3-light-grey w3-bar-block" style="width:10%;left:0; top: 0%;">

  <div class="logo">
      <span class="icon fa-diamond"></span>
  </div>


  <a href="#" class="w3-bar-item w3-button">TraVerse</a>


  <p>A music sharing site </p>


  <a href="#" class="w3-bar-item w3-button">Playlist 1</a>
  <a href="#" class="w3-bar-item w3-button">Playlist 2</a>
  <a href="#" class="w3-bar-item w3-button">Playlist 3</a>
  <a href="#" class="w3-bar-item w3-button">Playlist 4</a>
  <a href="#" class="w3-bar-item w3-button">Playlist 5</a>
</div>
                              -->

<!-- Main -->
<div id="main">
	<article id="songUpload" style=position:absolute>
		<form action="http://localhost:8080/#">
		<h2 class="major">Upload your Track</h2>

			<div class="field half first">
				<label for="name">Name</label>
				<input type="text" name="name" id="name" />
			</div>
			<div class="field half">
				<label for="my_file">Your File</label>
				<input type="file" id="my_file" accept=".wav, .mp3">
			</div>
			<div class="field">
				<label for="message">Track Description</label>
				<textarea name="message" id="message" rows="4"></textarea>
			</div>

			<ul class="actions">
				<li><button onclick=addTrack()>Submit</button></li>
				<li><input type="reset" value="Reset" /></li>
			</ul>
		</form>
	</article>
	<!-- Footer -->
	<footer id="footer">
		<p class="copyright">&copy; Untitled. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
	</footer>

</div>

<!-- BG -->
<div id="bg"></div>

<!-- Scripts -->

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/skel.min.js"></script>
<script src="/assets/js/util.js"></script>
<script src="/assets/js/main.js"></script>
<script src="/assets/js/jquery-3.2.1.js"></script>
<script src="/assets/js/forAuth.js"></script>

<script>
    document.getElementById('get_file').onclick = function() {
        document.getElementById('my_file').click();
    };
</script>
<script>
	function addTrack() {
        var ownerID;
		var grabID = {
		    "url": "http://localhost:8080/data/audio/ 	",
			"method": "GET",
			"data": String
		};
        $.ajax(grabID).done(function (response) {
             ownerID = response;
        });
        var form = new FormData();
        form.append("name", document.getElementById('name'));
        form.append("ownerID",ownerID);
        form.append("description", document.getElementById('message'));
        form.append("file", document.getElementById('my_file'));

        var settings = {
            "async": true,
            "crossDomain": true,
            "url": "http://localhost:8080/data/audio/create",
            "method": "POST",
            "headers": {
                "cache-control": "no-cache",
                "postman-token": "5bf9a76d-129a-cbec-a4c4-744dc374ecf3"
            },
            "processData": false,
            "contentType": false,
            "mimeType": "multipart/form-data",
            "data": form
        };

        $.ajax(settings).done(function (response) {
            console.log(response);
        });
    }
        /*var trackName = document.createElement('div');
        trackName.innerHTML = "fresh uploadddddddd";
        document.getElementById("child").appendChild(trackName);
        var trackAudio = document.createElement('audio');
        trackAudio.getAsFile();
		document.getElementById("child").appendChild(trackAudio);
	}
</script>
<script>
	function listTracks() {
        $.ajax({
            type: 'GET',
            url: '/audio/list',
			dataType:'text/html'
        });
	}
</script>
</body>
</html>